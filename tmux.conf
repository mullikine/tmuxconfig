# tmux-tmux-code git commit 648ce2f

set -g buffer-limit 30
set -g set-titles on
set -g set-titles-string "#h #S"
set -g renumber-windows on
set -g word-separators " -_@:=.;()[]/\\{}\"\',"

set -g history-limit 1000
set -g default-shell '/home/shane/local/bin/zsh'

set -g set-clipboard on
set -g default-terminal "screen-256color"
setenv -u -g COLUMNS
setenv -u -g LINES
set -g status-utf8 on
set -g mouse-resize-pane on # incompatible with select-window in 1.5
set -g mouse-select-pane on
set -g mouse-select-window on
set -g base-index 1
set -g status-interval 30
set -g status-left-length 40
set -g status-right-length 40
set -g pane-border-bg black
set -g pane-border-fg colour234
set -g pane-active-border-bg black
set -g pane-active-border-fg colour234
set -g pane-active-border-bg colour234
set -g status-right ""
set -g status-left '#S'
set -g mode-keys emacs # overrides EDITOR
set -g escape-time 1000 # speed up vim (increase on very slow connections) and timeoutlen in vimrc
set -g update-environment "DISPLAY SSH_ASKPASS SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION WINDOWID XAUTHORITY" #LC_TYPE LANG PAGER TMUX
set -g lock-command "vlock"

# 160 0xa0 red
# 124 0x7c dark red
# 233 0xe9 dark grey
# 234 0xea 'not as dark' grey
# 235 0xeb 'just readable' grey
# 236 0xec 'more clearly readable' grey
# 244 0xf4 light grey
# 250 0xfa lighter grey        regular windows
# 254 0xfe almost white        subsession window-name
set -g message-bg black
set -g message-fg colour134
set -g status-right-fg colour124
set -g status-left-fg colour124
set -g status-bg black
set -g window-status-format "#[fg=colour244]#I #[fg=colour240]#W"
set -g window-status-current-format "#[fg=colour244]#I #[fg=colour134]#W"

setw -g c0-change-interval 200
setw -g c0-change-trigger 50
setw -g clock-mode-colour colour234
setw -g clock-mode-style 24
setw -g mode-bg colour25
setw -g mode-fg colour254
setw -g window-status-fg colour234
setw -g window-status-current-fg white

setw -g alternate-screen on
setw -g mode-mouse off
setw -g word-separators ' -_@/()'
setw -g utf8 on
setw -g automatic-rename off
setw -g xterm-keys on
setw -g aggressive-resize on

set -g prefix "F1"
# for same reason '#h' stopped working, so I changed to the less desirable '#H'
bind V capture-pane -S -32768 \; run 'tmux save-buffer $HOME/computer/programs/tmux/capture/tmux_capture$(tmux display-message -p "_#H_#S:#I(#W).#P")_date:$(date +%d.%m.%y).txt' \; neww -n 'vim-capture' 'vim $HOME/computer/programs/tmux/capture/tmux_capture$(tmux display-message -p "_#H_#S:#I(#W).#P")_date:$(date +%d.%m.%y).txt'
bind Y capture-pane -S -32768 \; run 'tmux save-buffer $HOME/computer/programs/tmux/capture/tmux_capture$(tmux display-message -p "_#H_#S:#I(#W).#P")_date:$(date +%d.%m.%y).txt'
bind ! break-pane \; refresh
bind M-b run 'tmux-breakpane.sh'
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind F1 send-prefix #depth 2
bind -n F2 send-prefix #depth 2
bind -n F3 send-prefix \; send-prefix #depth 3
bind -n F4 send-prefix \; send-prefix \; send-prefix #depth 4
bind -n F5 send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 5
bind -n F6 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 6
bind -n F7 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 7
bind -n F8 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 8
bind -n F9 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 9
bind -n F10 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 10
bind -n F11 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 11
bind -n F12 send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix \; send-prefix #depth 12
bind -n C-M-k send "up"
bind -n C-M-j send "down"
bind -n C-M-l send "right"
bind S-F1 send F1
bind S-F2 send F2
bind S-F3 send F3
bind S-F4 send F4
bind S-F5 send F5
bind S-F6 send F6
bind S-F7 send F7
bind S-F8 send F8
bind S-F9 send F9
bind S-F10 send F10
bind S-F11 send F11
bind S-F12 send F12
bind r source-file ~/.tmux.conf \; refresh-client \; run "killall -SIGWINCH zsh"
bind e respawnp -k \; refresh
bind '$' command-prompt "rename-session \"%%\""
bind ',' command-prompt "rename-window \"%%\""
bind / command-prompt "split-window \"exec man %%\""
bind ^ command-prompt -p session_name "neww -n \"%1\" \"if [ ! -z \\\"%1\\\" ]; then unset TMUX;tmux attach -t \\\"%1\\\" || tmux new -s \\\"%1\\\"; set -t %1 status-right \\\"\\\"; fi\""
bind * command-prompt -p ssh_target -I '' "set set-remain-on-exit on; neww -n '%1' \"ssh %1\"; set set-remain-on-exit off"
bind 0 selectw -t :10 \; refresh
bind 1 selectw -t :1 \; refresh
bind 2 selectw -t :2 \; refresh
bind 3 selectw -t :3 \; refresh
bind 4 selectw -t :4 \; refresh
bind 5 selectw -t :5 \; refresh
bind 6 selectw -t :6 \; refresh
bind 7 selectw -t :7 \; refresh
bind 8 selectw -t :8 \; refresh
bind 9 selectw -t :9 \; refresh
bind P splitw -h -p 38 "exec vim .tmux/.postits" \; refresh
bind g set -gq status off
bind t set -gq status on
bind Q command-prompt -p 'man what?' "neww -n 'man-%1' -t 'man:' 'man %1'; setw remain-on-exit on"
bind a last-window \; refresh
bind m last-window \; refresh
bind s choose-session \; refresh
bind w choose-window \; refresh
bind N neww vim
bind % splitw -h
bind "\"" splitw -v
bind W command-prompt -I 'Be careful ' -p 'warning:' "neww -n 'Warning' \"echo '%1'|less\"; setw window-status-format '#[fg=colour244]#I#F#[fg=colour226]#W'"
bind \ command-prompt -I '' -p 'command:' "splitw -p 38 -h 'bash -lc \"%1\"'"
bind X unlinkw
bind C linkw -d -t current: \; selectw -t 1
bind G neww 'gitk --max-count=30'
bind T run "tmux-subsession-ask.sh"
bind M neww 'mc'
bind u neww 'ranger'
bind H neww 'htop'
bind y neww
bind U neww -n tasks "bash -lc '$HOME/home/scripts/tmux_task.sh $(tmux display -p \"#S\")-tw `pwd`'"

bind -r C-k resize-pane -U 2
bind -r C-j resize-pane -D 2
bind -r C-h resize-pane -L 4
bind -r C-l resize-pane -R 4
bind -r M-Up resize-pane -U 10
bind -r M-Down resize-pane -D 10
bind -r M-Left resize-pane -L 10
bind -r M-Right resize-pane -R 10
bind -r n next-window \; refresh \; run "killall -SIGWINCH zsh"
bind -r p previous-window \; refresh \; run "killall -SIGWINCH zsh"
bind -r o select-pane -t :.+ \; run "killall -SIGWINCH zsh"
bind -r ( switch-client -p \; refresh
bind -r ) switch-client -n \; refresh
bind -r O run 'tmux lastp; target=$(tmux lsp | grep -Po "^[^:]+(?=.*active)"); tmux lastp; tmux swapp -s "$target"'
bind -r C-q run 'stopemacsdaemon;killall -u $USER autossh ssh sshd tmux'

unbind -t emacs-copy M-R
bind -t emacs-copy M-e bottom-line
bind -t emacs-copy M-t top-line

bind -n C-l send "C-l" \; clear-history

bind \; command-prompt
bind : last-pane

# #S Session name
# #I Current window index
# #P Current pane index
bind C-p pipe-pane 'cat >> $HOME/computer/programs/tmux/capture/tmux_pipe_#H_#S:#I\(#W\).#P_date:`date +%d.%m.%y`.tty'

bind M-j run 'tmux-jira.sh'
bind M-c command-prompt -p "copy from:" "run 'tmux-copy-remote.sh %1'"
bind M-v command-prompt -p "copy to:" "run 'tmux-send-remote.sh %1'"
# tmux → xclip
bind v run "tmux-send-xclip.sh"
# xclip → tmux
bind c run "tmux-receive-xclip.sh"
bind C-v run "bash -c \"tmux-receive-xclip.sh; tmux paste-buffer\""
bind z neww "echo -n ""|vipe|head -c -1|tmux load-buffer -\;nohup zsh -c \"DISPLAY=:0 TMUX_PANE=$(tmux display-message -p '#{pane_id}') tmux paste-buffer\""
bind C-e neww "tmux save-buffer -|vipe|tee >(tmux delete-buffer)|tmux load-buffer -"
bind C-r neww -n edit_clipboard "DISPLAY=:0 xclip -o -selection primary 2>/dev/null |vipe|tee >(xclip -i -selection primary) >(xclip -i -selection clipboard)|tmux load-buffer -"
bind F run "tmux-ff.sh"
